@* @model ResturantParams
@{
    ViewData["Title"] = "Home";
    var allCities = (List<City>)ViewBag.Cities;
}

<form id="myForm" asp-action="Index" asp-action="Restaurant">
    <label>Resturant Name</label>
    <input id="RestName" asp-for="RestaurantName" />
    <input id="regionId" asp-for="RegionId" hidden/>

    <select id="city" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example">
        @foreach (var i in allCities)
        {
            <option value="@i.Id">@i.Name</option>
        }
    </select>
    


    <dialog id="myDialog">
        <h2>Dialog Title</h2>

        <div class="col-md-4">
            <ul id="districtList" class="list-group" style="display: none;">
                <li class="list-group-item">Districts will appear here</li>
            </ul>
        </div>
        <div class="col-md-4">
            <ul id="regionList" class="list-group" style="display: none;">
                <li class="list-group-item">Regions will appear here</li>
            </ul>
        </div>

        <button onclick="closeDialog()">Close</button>
    </dialog>



    <input id="btnGo" type="submit" value="Go" />
</form>

<!-- Add this line before your script -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
    $('#btnGo').click(function (e) {
        e.preventDefault();
        var cityId = $('#city').val();
        var RestaurantName = $('#RestName').val;

        var dialog = document.getElementById("myDialog");
        dialog.showModal();

        displayDistricts(cityId);

        $('#districtList').on('click', '.districtbtn', function (event) {
            event.preventDefault();
            var districtId = $(this).attr('data-districtId');
            var cityId = $(this).attr('data-cityId');
            displayRegions(cityId, districtId);
        });

        // Event listener for clicking on a region
        $('#regionList').on('click', '.regionbtn', function (event) {
            event.preventDefault();
            var region = $(this).attr('data-regionId');
            var district = $(this).attr('data-districtId');
            var city = $(this).attr('data-cityId');


            // Create the location object to send to the server
            var locationVM = {
                cityId: parseInt(city),
                districtId: parseInt(district),
                regionId: parseInt(region)
            };

            console.log(locationVM);

            var form = document.getElementById("myForm");
            // Make an AJAX POST request to the SetLocation action
            $.ajax({
                url: '@Url.Action("SetLocation", "Location")',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(locationVM),
                success: function (response) {
                    // Redirect to the Home/Index page
                    $('#regionId').attr('value', region);
                    closeDialog();
                    form.submit();
                },
                error: function (xhr, status, error) {
                    window.location.href = '@Url.Action("Home", "Restaurant")';
                    console.error('Error:', error);
                    // Handle the error if needed
                }
            });


        });
            //Function to display districts for the selected city
            function displayDistricts(cityId) {
                $.getJSON('@Url.Action("GetDistrictsByCityId", "District")', { cityId: cityId }, function (data) {
                    console.log(data);
                    $('#districtList').empty().show();
                    $.each(data, function (index, district) {

                        var districtItem = $('<li class="list-group-item"><button class="districtbtn" data-cityId=' + cityId + ' data-districtId="' + district.id + '">' + district.name + '</button></li>');
                        $('#districtList').append(districtItem);
                    });
                });
            }

            //Function to display regions for the selected district
            function displayRegions(cityId, districtId) {
                $.getJSON('@Url.Action("GetRegionsByDestrictId", "Region")', { districtId: districtId }, function (data) {
                    $('#regionList').empty().show();
                    $.each(data, function (index, region) {
                        $('#regionList').append('<li class="regionItem list-group-item">' + '<button class="regionbtn" data-cityId=' + cityId + ' data-districtId=' + districtId + ' data-regionId= ' + region.id + '  class= "districtItem" >' + region.name + '</button></li >');
                    });
                });
            }

    });

    function closeDialog() {
        var dialog = document.getElementById("myDialog");
        dialog.close();
    }
</script> *@


@* /////////////////////////////////////////// *@

@model ResturantParams
@{
	ViewData["Title"] = "Home";
	var allCities = (List<City>)ViewBag.Cities;

}




<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Menus</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
		  integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
		  crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
		  integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">

	<link rel="stylesheet" href="./css/homepage.css">
</head>

<body>
	<div id="Main-section">

		<nav class="navbar navbar-expand-lg text-light bg-transparent" style="z-index: 100; ">
			<div class="container-fluid">
				<div class="container d-flex justify-content-between">
					<div class="logo">
						<div class="logo-img">
							<img src="/public/img/elmenusLogo.svg" draggable="false" alt="elmenus">
						</div>
					</div>

					<!-- NOTE----- If a user is a GUEST (not logged in), use this div ONLY and comment the one below it in the NOTE -->
					@*                     <div class="pull-right right-side">
					<div class="account">
					<div class="not-loggedin">
					<button type="button" class="btn btn-link text-light login-btn text-decoration-none">
					login
					</button> <button type="button" class="btn btn-primary signup-btn text-decoration-none"
					style="background-color: #E22207; border:none;">
					signup
					</button>
					<a href=" /ar " type="button" class="btn btn-link login-btn text-light lang-switcher text-decoration-none">
					العربية
					</a>
					</div>
					</div>
					</div> *@

					<!-- ///////////////////////////////////////////// -->
				</div>

				<!-- NOTE----- If a user is logged in, use this div ONLY and comment the  one above it in the NOTE -->
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<a href=" /ar " type="button"
					   class="btn btn-link login-btn text-light lang-switcher text-decoration-none">
						العربية
					</a>
					<ul class="navbar-nav ms-auto mb-2 mb-lg-0 profile-menu">
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle text-light" href="#" id="navbarDropdown" role="button"
							   data-bs-toggle="dropdown" aria-expanded="false">
								<img src="https://source.unsplash.com/250x250?girl" width="35" class="rounded-circle"
									 alt="Profile Picture">
								<span class="text-light">UserName</span>
							</a>
							<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
								<li>
									<a class="dropdown-item" href="#"><i class="fas fa-sliders-h fa-fw"></i> Account</a>
								</li>
								<li><a class="dropdown-item" href="#"><i class="fas fa-cog fa-fw"></i> Settings</a></li>
								<li>
									<hr class="dropdown-divider">
								</li>
								<li>
									<a class="dropdown-item" href="#">
										<i class="fas fa-sign-out-alt fa-fw"></i> Log
										Out
									</a>
								</li>
							</ul>
						</li>
					</ul>
				</div>

				<!-- ////////////////////////////////// -->
			</div>
		</nav>

		<section>
			<div class="s013">
				<form asp-action="Index" asp-controller="Restaurant">
					<fieldset>
						<legend style="font-size: 60px;">Discover & Order</legend>
						<legend style="font-size: 50px;">the food you love!</legend>
					</fieldset>
					<div class="inner-form">
						<div class="left">
							<div class="input-wrap first">
								<div class="input-field first">
									<label>Restaurant Name</label>
									<input asp-for="RestaurantName" type="text" placeholder="Find all you favorite restaurant here..." />
								</div>
							</div>
							<div class="input-wrap second" style="background-color: #C3C6C8;">

								<select  class="form-select form-select-lg mb-3" aria-label=".form-select-lg example">
									@foreach (var i in allCities)
									{
										<option value="@i.Id">@i.Name</option>
									}
								</select>
							</div>
						</div>
						<button id="Go" class="btn-search" type="submit">GO!</button>
					</div>
				</form>
			</div>

			@* THIS IS THE DIALOG I MADE *@
			<dialog id="locationDialog" class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Branch Delivering Area</h5>
						<button type="button" class="close" onclick="closeDialog()">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<div class="container">
							<div class="row">
								<div class="col-md-4">
									<ul id="cityList" class="list-group">
										@foreach (var city in allCities)
										{
											<li class="list-group-item">
												<button class="citybtn btn btn-primary" data-cityId="@city.Id">@city.Name</button>
											</li>
										}
									</ul>
								</div>
								<div class="col-md-4">
									<ul id="districtList" class="list-group" style="display: none;">
										<li class="list-group-item">Districts will appear here</li>
									</ul>
								</div>
								<div class="col-md-4">
									<ul id="regionList" class="list-group" style="display: none;">
										<li class="list-group-item">Regions will appear here</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</dialog>

			<div class="services mt-5">
				<legend class="mb-4" style="text-align: center; color:white; font-weight:bolder; ">
					Or Explore El-Menus
				</legend>
				<div class="container">
					<div class="d-flex justify-content-center">
						<div class="row bg-light" style="width: 60%;">
							<button class="col-lg-6 col-md-6 col-sm-6 border border-2 p-4" style="text-align: left;">
								<img width="25" height="25"
									 src="https://img.icons8.com/ios/50/motorcycle-delivery-single-box.png"
									 alt="motorcycle-delivery-single-box" />
								<span class="fs-5">Delivery</span> <br>
								<p class="mt-2 text-muted w-100" style="font-size: small;">
									Get food delivered from
									amazing restaurants around you
									<img width="20" height="25"
										 src="https://img.icons8.com/ios/50/long-arrow-right--v1.png"
										 alt="long-arrow-right--v1" />
								</p>
							</button>
							<button class="col-lg-6 col-md-6 col-sm-6 border border-2 p-4" style="text-align: left;">
								<img width="25" height="25" src="https://img.icons8.com/ios/50/restaurant.png"
									 alt="restaurant" />
								<span class="fs-5">Dine In</span> <br>
								<p class="mt-2 text-muted w-100" style="font-size: small;">
									Browse restaurants by
									mood, cuisine, area, or dish names
									<img width="20" height="25"
										 src="https://img.icons8.com/ios/50/long-arrow-right--v1.png"
										 alt="long-arrow-right--v1" />
								</p>
							</button>
						</div>
					</div>
				</div>
			</div>

		</section>
	</div>

	<section id="middle-sec">
		<p>Now you can</p>
		<h1>ORDER ONLINE</h1>
		<div class="container mt-4">
			<div class="d-flex justify-content-center">
				<div class="row flex-row mx-5 p-5">
					<div class="col-lg-6 col-md-6 col-sm-6 ">
						<div class="card shadow-lg p-3 mb-5 bg-body p-2 border border-0"
							 style="height: 80%; border-radius: 20px;">
							<div class="d-flex align-items-center">
								<img width="40" src="~/imagesStyle/icons8-track-order-64.png" alt="track_your_order" />
								<h3 class="ps-2">
									Track your order <span style="color: red; font-size:25px; display:block;">
										(Coming
										Soon!)
									</span>
								</h3>
							</div>
							<div class="d-flex align-self-end">
								<h6 class="text-muted mt-3">
									Want to know your order status? No problem, Now you can know exactly where your
									order is throughout the delivery process.
								</h6>
							</div>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 ">
						<div class="card shadow-lg p-3 mb-5 bg-body p-2 border border-0"
							 style="height: 80%; border-radius: 20px;">
							<div class="d-flex align-items-center">
								<img width="40" src="~/imagesStyle/icons8-no-phones-50.png" alt="no calls" />
								<h3 class="ps-2">
									No Phone calls! <span style="color: white; user-select:none; font-size:25px; display:block;">
										(Coming
										Soon!)
									</span>
								</h3>
							</div>
							<div class="d-flex align-self-end">
								<h6 class="text-muted mt-3">
									Order your favorite food easier, faster, and without phone calls.
								</h6>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<section class="section-2">
		<div class="section-title">
			<h3>Looking for delivery</h3>
		</div>

		<div class="section2-content">
			<p>
				Look for restaurants that have this sign
				<span>
					<span>
						<img width="20px" height="20px" src="~/imagesStyle/icons8-guarantee-50.png" alt="Guarantee">
					</span>
					<span class="fs-6 fw-bold" style="color:#8e52ff; ">Order online</span>
				</span>
			</p>
			<a href="/cairo/delivery?orderingEnabled=true" class="btn btn-primary delivery-btn">
				Order online now
			</a>
		</div>
	</section>

	<div class="footer-clean">
		<footer>
			<div class="container">
				<div class="row justify-content-center">
					<div class="col-sm-4 col-md-3 item">
						<h3>Services</h3>
						<ul>
							<li><a href="#">Web design</a></li>
							<li><a href="#">Development</a></li>
							<li><a href="#">Hosting</a></li>
						</ul>
					</div>
					<div class="col-sm-4 col-md-3 item">
						<h3>About</h3>
						<ul>
							<li><a href="#">Company</a></li>
							<li><a href="#">Team</a></li>
							<li><a href="#">Legacy</a></li>
						</ul>
					</div>
					<div class="col-sm-4 col-md-3 item">
						<h3>Careers</h3>
						<ul>
							<li><a href="#">Job openings</a></li>
							<li><a href="#">Employee success</a></li>
							<li><a href="#">Benefits</a></li>
						</ul>
					</div>
					<div class="col-lg-3 item social">
						<a href="#"><i class="icon ion-social-facebook"></i></a><a href="#"><i class="icon ion-social-twitter"></i></a><a href="#">
							<i class="icon ion-social-snapchat"></i>
						</a><a href="#">
							<i class="icon ion-social-instagram"></i>
						</a>
						<p class="copyright">Company Name © 2018</p>
					</div>
				</div>
			</div>
		</footer>
	</div>

	<script>
		document.querySelectorAll('.dropdown-toggle').forEach(item => {
			item.addEventListener('click', event => {

				if (event.target.classList.contains('dropdown-toggle')) {
					event.target.classList.toggle('toggle-change');
				}
				else if (event.target.parentElement.classList.contains('dropdown-toggle')) {
					event.target.parentElement.classList.toggle('toggle-change');
				}
			})
		});


		function openDialog() {
			var dialog = document.getElementById("locationDialog");
			dialog.showModal();
		}

		// Function to close the dialog
		function closeDialog() {
			var dialog = document.getElementById("locationDialog");
			dialog.close();
		}

		$(function () {

			$('#Go').on('click', function (e) {
				e.preventDefault();
				openDialog();
			})

			// Event listener for clicking on a city
			$('#cityList').on('click', '.citybtn', function (event) {
				event.preventDefault();
				//var cityId = $(this).data('cityId');
				var cityId = $(this).attr('data-cityId');
				console.log("City ID:", cityId);
				displayDistricts(cityId);
			});

			// Event listener for clicking on a district
			$('#districtList').on('click', '.districtbtn', function (event) {
				event.preventDefault();
				var districtId = $(this).attr('data-districtId');
				var cityId = $(this).attr('data-cityId');
				displayRegions(cityId, districtId);
			});

			// Event listener for clicking on a region
			$('#regionList').on('click', '.regionbtn', function (event) {
				event.preventDefault();
				var region = $(this).attr('data-regionId');
				var district = $(this).attr('data-districtId');
				var city = $(this).attr('data-cityId');


				// Create the location object to send to the server
				var locationVM = {
					cityId: parseInt(city),
					districtId: parseInt(district),
					regionId: parseInt(region)
				};
				console.log(locationVM);
				// Make an AJAX POST request to the SetLocation action
				$.ajax({
					url: '@Url.Action("SetLocation", "Location")',
					type: 'POST',
					contentType: 'application/json',
					data: JSON.stringify(locationVM),
					success: function (response) {
						// Redirect to the Home/Index page
						window.location.href = '@Url.Action("Index", "Home")';
					},
					error: function (xhr, status, error) {
						console.error('Error:', error);
						// Handle the error if needed
					}
				});


			});

			//Function to display districts for the selected city
			function displayDistricts(cityId) {
				$.getJSON('@Url.Action("GetDistrictsByCityId", "District")', { cityId: cityId }, function (data) {
					console.log(data);
					$('#districtList').empty().show();
					$.each(data, function (index, district) {

						var districtItem = $('<li class="list-group-item"><button class="districtbtn" data-cityId=' + cityId + ' data-districtId="' + district.id + '">' + district.name + '</button></li>');
						$('#districtList').append(districtItem);
					});
				});
			}

			//Function to display regions for the selected district
			function displayRegions(cityId, districtId) {
				$.getJSON('@Url.Action("GetRegionsByDestrictId", "Region")', { districtId: districtId }, function (data) {
					$('#regionList').empty().show();
					$.each(data, function (index, region) {
						$('#regionList').append('<li class="regionItem list-group-item">' + '<button class="regionbtn" data-cityId=' + cityId + ' data-districtId=' + districtId + ' data-regionId= ' + region.id + '  class= "districtItem" >' + region.name + '</button></li >');
					});
				});
			}

		});

	</script>
	<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js'></script>
</body>

</html>

 
